language: node_js
node_js:
  - "10"

stages:
  - test
  - build

jobs:
  include:

    - stage: test
      name: "Lint"
      if: type = push
      script:
        - npm run lint

    - stage: build
      name: "Gitlab Mirror Trigger"
      if: type = push
      before_script:
        - sudo apt-get install -y curl
      script:
        - "curl --request POST --header \"PRIVATE-TOKEN: ${GITLAB_TOKEN}\" https://gitlab.com/api/v4/projects/13691195/mirror/pull"

    - stage: build
#    - stage: test
#      name: "Tests"
#      if: branch IN (develop, master) AND type = pull_request
      script: 'echo "test"'
#
#    - stage: build
#      name: "Build Artifacts"
#      if: (branch = master OR tag IS present) AND type = push
#      addons:
#        artifacts:
#          working_dir: build/zip/
#          paths:
#            - echo_bridge.zip
#      script:
#        - npm run build-ext
#        - "echo \"Download URL: https://${ARTIFACTS_BUCKET}.s3.amazonaws.com/echoprotocol/bridge-extension/${TRAVIS_BUILD_NUMBER}/${TRAVIS_JOB_NUMBER}/echo_bridge.zip\""
