cache:
  paths:
  - node_modules/

stages:
  - lint
  - prepare
  - deploy

eslint:
  stage: lint
  script:
    - npm install
    - npm run lint
  only:
     - triggers
  tags:
    - pp-projects

deploy:
  stage: deploy
  script:
    - cd /home/devuser/DevProjects/645.echo_web/desktop
    - git pull origin master
    - npm install
    - npm run build-dev
  only:
    - master
  tags:
    - pp-projects

build.macos:
  stage: deploy
  script:
    - npm install
    - npm run package-prepare
    - npm run package-osx
  only:
    - web
    - tags
  tags:
    - echo-mac
  artifacts:
     paths:
     - dist/Echo.dmg
     expire_in: 1 week


build.linux:
  stage: deploy
  script:
    - npm install
    - npm run package-prepare
    - npm run package-linux
  only:
    - web
    - tags
  tags:
    - echo-linux
  artifacts:
     paths:
     - dist/installers/echo-0.0.1.x86_64.rpm
     expire_in: 1 week